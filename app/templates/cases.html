{% extends "base.html" %}

{% block title %}Case Repository - AI Ethical Decision-Making Simulator{% endblock %}

{% block content %}
<div class="container">
    <h1 class="mb-4">Case Repository</h1>

    {% if error %}
    <div class="alert alert-danger" role="alert">
        Error loading cases: {{ error }}
    </div>
    {% endif %}

    <div class="row mb-4">
        <div class="col-md-6">
            <form class="d-flex" action="/cases/search" method="get">
                <input class="form-control me-2" type="search" placeholder="Search cases..." name="query"
                    aria-label="Search">
                <button class="btn btn-outline-primary" type="submit">Search</button>
            </form>
        </div>
        <div class="col-md-6 text-end">
            <div class="btn-group">
                <a href="/cases/new" class="btn btn-success">Add New Case</a>
                <a href="/cases/triple/new" class="btn btn-primary">
                    <i class="bi bi-diagram-3"></i> Create Triple-Based Case
                </a>
            </div>
        </div>
    </div>

    {% if cases %}
    {% for case in cases %}
    <div class="card mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h3>{{ case.title }}</h3>
            <span class="badge bg-primary">Case #{{ case.id }}</span>
        </div>
        <div class="card-body">
            <h5>Description</h5>
            <p class="card-text">{{ case.description }}</p>

            <h5 class="mt-3">Decision</h5>
            <p class="card-text">{{ case.decision }}</p>

            {% if case.outcome %}
            <h5 class="mt-3">Outcome</h5>
            <p class="card-text">{{ case.outcome }}</p>
            {% endif %}

            {% if case.ethical_analysis %}
            <h5 class="mt-3">Ethical Analysis</h5>
            <p class="card-text">{{ case.ethical_analysis }}</p>
            {% endif %}

            <div class="mt-3">
                <a href="/cases/{{ case.id }}" class="btn btn-primary">View Details</a>
            </div>
        </div>
    </div>
    {% endfor %}
    {% else %}
    <div class="alert alert-info" role="alert">
        No cases available. Please check the MCP server connection or add new cases.
    </div>
    {% endif %}

    <div class="mt-4">
        <h2>About the Case Repository</h2>
        <p>
            This repository contains historical engineering ethics cases where abstract principles were applied to
            concrete situations.
            Each case provides insight into how ethical principles are operationalized - that is, how the gap between
            abstract rules
            and specific facts is bridged through reasoning and explanation by ethics experts.
        </p>
        <p>
            The cases in this repository serve as reference points for analogical reasoning when evaluating new ethical
            dilemmas. They demonstrate how seemingly conflicting principles (such as duty to public safety versus
            obligation
            of confidentiality) can be weighed and resolved in specific contexts.
        </p>
        <p>
            Each case includes:
        </p>
        <ul>
            <li><strong>Description</strong> - The detailed scenario and context of the ethical dilemma</li>
            <li><strong>Decision</strong> - The ethical judgment reached about the engineer's actions</li>
            <li><strong>Outcome</strong> - The consequences of the decision</li>
            <li><strong>Ethical Analysis</strong> - Expert reasoning that links abstract principles to specific facts
            </li>
        </ul>
        <p>
            Cases may be represented in two complementary formats:
        </p>
        <ul>
            <li><strong>Standard Format</strong> - Traditional narrative representation with structured fields</li>
            <li><strong>Triple-Based Format</strong> - Semantic representation using RDF triples to express complex
                relationships
                between principles, actions, and outcomes</li>
        </ul>
        <p>
            The triple-based approach enables more sophisticated queries across cases to identify patterns in ethical
            reasoning
            and principle application.
        </p>
    </div>
</div>
{% endblock %}